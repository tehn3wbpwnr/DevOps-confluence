<!DOCTYPE html>
<html>
    <head>
        <title>DevOps / Pipeline &amp; Deployment : Jenkins Security</title>
        <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=UTF-8">
    </head>

    <body class="theme-default aui-theme-default">
        <div id="page">
            <div id="main" class="aui-page-panel">
                <div id="main-header">
                    <div id="breadcrumb-section">
                        <ol id="breadcrumbs">
                            <li class="first">
                                <span><a href="index.html">DevOps / Pipeline &amp; Deployment</a></span>
                            </li>
                                                    <li>
                                <span><a href="1179353439.html">DevOps / Pipeline &amp; Deployment Home</a></span>
                            </li>
                                                    <li>
                                <span><a href="Linux-Jenkins-Documents_1542455384.html">Linux Jenkins Documents</a></span>
                            </li>
                                                    <li>
                                <span><a href="Security-Management-on-VM_1584594948.html">Security Management on VM</a></span>
                            </li>
                                                </ol>
                    </div>
                    <h1 id="title-heading" class="pagetitle">
                                                <span id="title-text">
                            DevOps / Pipeline &amp; Deployment : Jenkins Security
                        </span>
                    </h1>
                </div>

                <div id="content" class="view">
                    <div class="page-metadata">
                            
        
    
        
    
        
        
            Created by <span class='author'> Chris Park</span>, last modified on Mar 11, 2025
                        </div>
                    <div id="main-content" class="wiki-content group">
                    <p><style>[data-colorid=jcyt8p839s]{color:#ffc400} html[data-color-mode=dark] [data-colorid=jcyt8p839s]{color:#ffc400}[data-colorid=wzcmesvp7o]{color:#ff5630} html[data-color-mode=dark] [data-colorid=wzcmesvp7o]{color:#cf2600}[data-colorid=vx9n8ghcyt]{color:#ff5630} html[data-color-mode=dark] [data-colorid=vx9n8ghcyt]{color:#cf2600}[data-colorid=efsbwxkcfw]{color:#ff5630} html[data-color-mode=dark] [data-colorid=efsbwxkcfw]{color:#cf2600}[data-colorid=wffnlp310q]{color:#ff5630} html[data-color-mode=dark] [data-colorid=wffnlp310q]{color:#cf2600}[data-colorid=eg2js1bzqi]{color:#ff5630} html[data-color-mode=dark] [data-colorid=eg2js1bzqi]{color:#cf2600}[data-colorid=d927orm29m]{color:#ff5630} html[data-color-mode=dark] [data-colorid=d927orm29m]{color:#cf2600}[data-colorid=j1fa8mi039]{color:#ffc400} html[data-color-mode=dark] [data-colorid=j1fa8mi039]{color:#ffc400}</style>: This document is for explaining Jenkins security related components.</p><hr /><h1 id="JenkinsSecurity-[Contents]"><strong>[ Contents ]</strong></h1><style type="text/css">/*<![CDATA[*/
div.rbtoc1748352807769 {padding: 0px;}
div.rbtoc1748352807769 ul {list-style: none;margin-left: 0px;}
div.rbtoc1748352807769 li {margin-left: 0px;padding-left: 0px;}

/*]]>*/</style><div class="toc-macro rbtoc1748352807769">
<ul class="toc-indentation">
<li><a href="#JenkinsSecurity-[Contents]">[ Contents ]</a></li>
<li><a href="#JenkinsSecurity-1.JenkinsServiceFile">1. Jenkins Service File</a>
<ul class="toc-indentation">
<li><a href="#JenkinsSecurity-EnvironmentVariables">Environment Variables</a></li>
<li><a href="#JenkinsSecurity-UserandGroupSettings">User and Group Settings</a></li>
</ul>
</li>
<li><a href="#JenkinsSecurity-2.NginXonJenkinsVM">2. NginX on Jenkins VM</a>
<ul class="toc-indentation">
<li><a href="#JenkinsSecurity-2.1ServerConfiguration">2.1 Server Configuration</a></li>
<li><a href="#JenkinsSecurity-2.2ReverseProxyforJenkins(location/)">2.2 Reverse Proxy for Jenkins (location /)</a></li>
<li><a href="#JenkinsSecurity-2.3ReverseProxyforSonarQube(location/sonarqube/)">2.3 Reverse Proxy for SonarQube (location /sonarqube/)</a></li>
</ul>
</li>
<li><a href="#JenkinsSecurity-3.RoleBasedAccessControl">3. Role Based Access Control</a></li>
<li><a href="#JenkinsSecurity-4.Credentials">4. Credentials</a>
<ul class="toc-indentation">
<li><a href="#JenkinsSecurity-4.1SystemLevelCredentials">4.1 System Level Credentials</a>
<ul class="toc-indentation">
<li><a href="#JenkinsSecurity-4.1.1Bitbucket-CI-Catherine-ED25519">4.1.1 Bitbucket-CI-Catherine-ED25519</a></li>
<li><a href="#JenkinsSecurity-4.1.2bitbucket-app-password(Currentlynotbeingused-shouldbedeleted)">4.1.2 bitbucket-app-password (Currently not being used - should be deleted)</a></li>
<li><a href="#JenkinsSecurity-4.1.3jenkins-api-key(Currentlynotbeingused)">4.1.3 jenkins-api-key (Currently not being used)</a></li>
<li><a href="#JenkinsSecurity-4.1.4SonarQube">4.1.4 SonarQube</a></li>
</ul>
</li>
<li><a href="#JenkinsSecurity-4.2ProjectLevelCredentials">4.2 Project Level Credentials</a>
<ul class="toc-indentation">
<li><a href="#JenkinsSecurity-4.2.1trigger-token">4.2.1 trigger-token</a></li>
<li><a href="#JenkinsSecurity-4.2.2bitbucket-access-token">4.2.2 bitbucket-access-token</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#JenkinsSecurity-5.SSHConnectionstoaWebHostServer">5. SSH Connections to a Web Host Server</a></li>
<li><a href="#JenkinsSecurity-6.ScriptApprovals">6. Script Approvals</a></li>
</ul>
</div><hr /><h1 id="JenkinsSecurity-1.JenkinsServiceFile"><strong>1. Jenkins Service File</strong></h1><p>: This is the <code>jenkins systemd </code>service file is at '<code>/lib/systemd/system/jenkins.service</code>'. It defines how Jenkins runs as a system service, including its <strong>user, group, startup parameters, and environment variables</strong>.</p><p> To check which <strong>environment variables</strong> are currently being used by the Jenkins service, you can run the following command:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">systemctl show jenkins | grep Environment</pre>
</div></div><p> This will display a list of <strong>all environment variables</strong> applied to the Jenkins process, including configurations related to logging, ports, and execution settings.</p><div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" /><div class="confluence-information-macro-body"><p>This <code>.service</code> file <strong>could be initialized</strong> after the &lsquo;<code>apt upgrade</code>'. If so, &ldquo;User and Group Settings&rdquo; should be updated again to &lsquo;<code>jenkins</code>' to <code>'jenkins-ubuntu-dev-test</code>&rsquo;</p><p>Please review <a href="https://varlab-dev.atlassian.net/wiki/spaces/DPD/pages/1678442513/Jenkins+service+failing?atlOrigin=eyJpIjoiNjJmNjNlZDEwNDIzNDgxYjg0ZmU4ZDZkN2MwYmJhZTciLCJwIjoiYyJ9" rel="nofollow"><u>this bug report</u></a> for trouble shooting</p></div></div><p /><h3 id="JenkinsSecurity-EnvironmentVariables"><strong>Environment Variables</strong></h3><p>: These are the system environment variables for Jenkins. </p><div class="table-wrap"><table data-table-width="760" data-layout="default" data-local-id="bf16e878-3e27-4a0a-a1f6-7fb59de6874c" class="confluenceTable"><colgroup><col style="width: 182.0px;" /><col style="width: 577.0px;" /></colgroup><tbody><tr><th data-highlight-colour="#f4f5f7" class="confluenceTh"><p><strong>Type of env variables</strong></p></th><th data-highlight-colour="#f4f5f7" class="confluenceTh"><p><strong>Descriptions</strong></p></th></tr><tr><td class="confluenceTd"><p><strong>JENKINS_HOME</strong></p></td><td class="confluenceTd"><p>Base <strong>data storage directory</strong> of Jenkins Service</p></td></tr><tr><td class="confluenceTd"><p><strong>WorkingDirectory</strong></p></td><td class="confluenceTd"><p>Base <strong>working(process) directory</strong> of Jenkins pipeline jobs </p></td></tr><tr><td class="confluenceTd"><p><strong>JENKINS_WEBROOT</strong></p></td><td class="confluenceTd"><p>The directory where Jenkins<strong> extracts its WAR file</strong> <strong>and stores necessary</strong> <strong>web resources</strong></p></td></tr><tr><td class="confluenceTd"><p><strong>JAVA_OPTS</strong></p></td><td class="confluenceTd"><p>JVM settings, <strong>important for performance and memory limits</strong>.<br />&gt;&gt; We are using 'headless=true' condition to disables GUI-dependent operations </p></td></tr><tr><td class="confluenceTd"><p><strong>JENKINS_PORT</strong></p></td><td class="confluenceTd"><p>The <strong>listening port number</strong> of Jenkins</p></td></tr><tr><td class="confluenceTd"><p><strong>JENKINS_LOG</strong></p></td><td class="confluenceTd"><p>Environment variable that specifies the <strong>file path for Jenkins' system-level log</strong></p></td></tr></tbody></table></div><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon" /><div class="confluence-information-macro-body"><p><strong>JENKINS_LOG</strong> <u>is disabled by default</u>, so if the system is updated or reinstalled,<strong> this option needs to be enabled again</strong>.</p></div></div><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon" /><div class="confluence-information-macro-body"><p><strong>System level of Jenkins service log</strong> can be found '<code>/var/log/jenkins/jenkins.log</code>'</p></div></div><p /><h3 id="JenkinsSecurity-UserandGroupSettings"><strong>User and Group Settings</strong></h3><p>: These are the user and group settings when Jenkins runs on <code>systemd</code>. The user and group <strong><span style="background-color: rgb(254,222,200);">should be matched with the VM host user</span></strong> to avoid permission issues. (e.g. <code>jenkins-ubuntu-dev-test</code>)</p><p /><hr /><h1 id="JenkinsSecurity-2.NginXonJenkinsVM"><strong>2. NginX on Jenkins VM</strong></h1><p>: Nginx configuration sets up a <strong>reverse proxy</strong> for <strong>Jenkins</strong> and <strong>SonarQube</strong>, ensuring secure access via <strong>HTTPS (port 443)</strong>. </p><p>Here&rsquo;s a summary of its key aspects:</p><h2 id="JenkinsSecurity-2.1ServerConfiguration"><strong>2.1 Server Configuration</strong></h2><ul><li><p>Listens on <strong>port 443</strong> with <strong>SSL enabled</strong></p></li><li><p>Defines <code>server_name</code> as <code>jenkins.vconestoga.com</code><br /></p></li></ul><h2 id="JenkinsSecurity-2.2ReverseProxyforJenkins(location/)"><strong>2.2 Reverse Proxy for Jenkins</strong> (<code>location /</code>)</h2><ul><li><p>Routes requests to <strong>Jenkins</strong> running on <code>http://127.0.0.1:8080</code> as a default</p></li><li><p>Passes client IP and request details via headers<br /></p></li></ul><h2 id="JenkinsSecurity-2.3ReverseProxyforSonarQube(location/sonarqube/)"><strong>2.3 Reverse Proxy for SonarQube</strong> (<code>location /sonarqube/</code>)</h2><ul><li><p>Routes requests to <strong>SonarQube</strong> at <code>http://127.0.0.1:9000/sonarqube/</code></p></li><li><p><strong>Access restrictions:</strong></p><ul><li><p>Requests are allowed if the <code>Origin</code> is <code>https://jenkins.vconestoga.com</code></p></li><li><p>Requests are allowed if the <code>Referer</code> is either <code>https://bitbucket.org</code> (for initial access) or <code>https://jenkins.vconestoga.com</code> (for client-side rendering).</p></li><li><p>If none of these conditions are met, the request is <strong>blocked with a 403 Forbidden response</strong></p></li></ul></li></ul><p /><hr /><h1 id="JenkinsSecurity-3.RoleBasedAccessControl"><strong>3. Role Based Access Control</strong></h1><p>: We can give restrict access permission to each Jenkins user. This setting can be found at &ldquo;<strong>Manage Jenkins &gt;&gt; Security &gt;&gt; Authorization</strong>&rdquo;.</p><span class="confluence-embedded-file-wrapper image-center-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image image-center" alt="화면 캡처 2025-03-10 162758-20250310-202924.png" width="760" loading="lazy" src="attachments/1668743208/1678540869.png?width=760" data-image-src="attachments/1668743208/1678540869.png" data-height="619" data-width="1632" data-unresolved-comment-count="0" data-linked-resource-id="1678540869" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="화면 캡처 2025-03-10 162758-20250310-202924.png" data-base-url="https://varlab-dev.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="1668743208" data-linked-resource-container-version="22" data-media-id="25d8de13-4871-4c8e-8fd9-5926c28d6157" data-media-type="file" /></span><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon" /><div class="confluence-information-macro-body"><p><strong>A role should be assigned</strong> when you create a new user. If not, a new user doesn&rsquo;t have any access.</p></div></div><span class="confluence-embedded-file-wrapper image-center-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image image-center" alt="image-20250311-140346.png" width="299" loading="lazy" src="attachments/1668743208/1681096717.png?width=299" data-image-src="attachments/1668743208/1681096717.png" data-height="109" data-width="401" data-unresolved-comment-count="0" data-linked-resource-id="1681096717" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20250311-140346.png" data-base-url="https://varlab-dev.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="1668743208" data-linked-resource-container-version="22" data-media-id="0397559a-0739-48cf-816b-dd0bf973e4f6" data-media-type="file" /></span><hr /><h1 id="JenkinsSecurity-4.Credentials"><strong>4. Credentials</strong></h1><p>: Jenkins has two types of credentials, system and project level credentials. Here are the credential and its usage Jenkins currently has.</p><h2 id="JenkinsSecurity-4.1SystemLevelCredentials"><strong>4.1 System Level Credentials</strong></h2><p>: This credentials can be shared in entire Jenkins jobs can found at &ldquo;Manage Jenkins &gt;&gt; Credentials&ldquo;</p><h3 style="margin-left: 30.0px;" id="JenkinsSecurity-4.1.1Bitbucket-CI-Catherine-ED25519"><strong>4.1.1 Bitbucket-CI-Catherine-ED25519</strong></h3><p style="margin-left: 30.0px;">: This Bitbucket SSH credential is used for accessing the project repository (e.g., for <code>git pull</code>). If misconfigured, Jenkins is highly likely to fail when initially pulling the '<strong>Jenkins</strong>' repository, preventing it from starting a build job.</p><p style="margin-left: 30.0px;"><strong>[References]</strong><br />&gt;&gt; <a class="external-link" href="https://support.atlassian.com/bitbucket-cloud/docs/configure-ssh-and-two-step-verification/" rel="nofollow"><u>Bitbucket SSH Configuration Documentation</u></a><br />&gt;&gt; <a href="https://varlab-dev.atlassian.net/wiki/spaces/DPD/pages/1508605968/Setting+Up+Jenkins+on+the+Linux+Virtual+Machine#2.2-Set-Up-Jenkins-Server-SSH-Key" rel="nofollow"><u>Bitbucket SSH Setup Documentation</u></a><u> </u></p><p /><h3 style="margin-left: 30.0px;" id="JenkinsSecurity-4.1.2bitbucket-app-password(Currentlynotbeingused-shouldbedeleted)"><strong>4.1.2 bitbucket-app-password <span data-colorid="j1fa8mi039">(Currently not being used - should be deleted)</span></strong></h3><p style="margin-left: 30.0px;">: Based on the <a class="external-link" href="https://support.atlassian.com/bitbucket-cloud/docs/using-app-passwords/" rel="nofollow"><u>Bitbucket documentation</u></a>, we can expect two features in our CI/CD pipeline.</p><p style="margin-left: 60.0px;"><strong>- Git repository access (HTTPS)</strong><br />:<strong> </strong>App Password enables authentication for cloning, pulling, and pushing repositories over HTTPS instead of SSH.<br /><span data-colorid="wffnlp310q">&gt;&gt; We are already using &ldquo;</span><strong><span data-colorid="eg2js1bzqi">SSH credential</span></strong><span data-colorid="efsbwxkcfw">&ldquo; for git repository access</span></p><p style="margin-left: 60.0px;"><strong>- Bitbucket API authentication</strong><br />: App Password allows secure API requests for managing pull requests, commits, repositories, and other Bitbucket resources.<br /><span data-colorid="d927orm29m">&gt;&gt; We are already using &ldquo;</span><strong><span data-colorid="vx9n8ghcyt">bitbucket-access-token</span></strong><span data-colorid="wzcmesvp7o">&ldquo; for API request</span></p><p style="margin-left: 30.0px;"> So, we may want to delete this credential from our Jenkins system.</p><span class="confluence-embedded-file-wrapper image-center-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image image-center" alt="image-20250311-153037.png" width="549" loading="lazy" src="attachments/1668743208/1681621011.png?width=549" data-image-src="attachments/1668743208/1681621011.png" data-height="165" data-width="549" data-unresolved-comment-count="0" data-linked-resource-id="1681621011" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20250311-153037.png" data-base-url="https://varlab-dev.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="1668743208" data-linked-resource-container-version="22" data-media-id="22a95458-1df0-4f61-a1a3-00230ecc1aef" data-media-type="file" /></span><span class="confluence-embedded-file-wrapper image-center-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image image-center" alt="image-20250311-152728.png" width="730" loading="lazy" src="attachments/1668743208/1681358862.png?width=730" data-image-src="attachments/1668743208/1681358862.png" data-height="235" data-width="904" data-unresolved-comment-count="0" data-linked-resource-id="1681358862" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20250311-152728.png" data-base-url="https://varlab-dev.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="1668743208" data-linked-resource-container-version="22" data-media-id="77e94fa1-f14e-4902-a574-16f97744aee0" data-media-type="file" /></span><p style="margin-left: 30.0px;"><strong>[References]</strong><br />&gt;&gt; <a class="external-link" href="https://support.atlassian.com/bitbucket-cloud/docs/using-app-passwords/" rel="nofollow"><u>Bitbucket App Password Usage Documentation</u></a><br />&gt;&gt; <a href="https://varlab-dev.atlassian.net/wiki/spaces/DPD/pages/1508605968/Setting+Up+Jenkins+on+the+Linux+Virtual+Machine#2.1-Set-Up-Bitbucket-App-Password" rel="nofollow"><u>Bitbucket App Password Setup Documentation</u></a></p><p /><h3 style="margin-left: 30.0px;" id="JenkinsSecurity-4.1.3jenkins-api-key(Currentlynotbeingused)"><strong>4.1.3 jenkins-api-key <span data-colorid="jcyt8p839s">(Currently not being used)</span></strong></h3><p style="margin-left: 30.0px;">: This token allows us to use the Jenkins API. It was previously used to retrieve Jenkins console logs for each build, but this feature is no longer part of our current Jenkins logic.</p><p style="margin-left: 30.0px;"> However, this credential may be useful in the future&mdash;for example, if we want to allow project leaders to remotely re-trigger PR Jenkins builds.</p><p style="margin-left: 30.0px;"> The token is assigned to the <strong>'ci-catherin'</strong> Jenkins user. You can find it under <strong>&quot;User &rarr; Security &rarr; API Token,&quot;</strong> as shown in the image below.</p><div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" /><div class="confluence-information-macro-body"><p>&quot;User &rarr; Security&quot; is <strong>only accessible through the corresponding account</strong></p></div></div><span class="confluence-embedded-file-wrapper image-center-wrapper confluence-embedded-manual-size"><img class="confluence-embedded-image image-center" alt="image-20250311-173920.png" width="670" loading="lazy" src="attachments/1668743208/1681391636.png?width=670" data-image-src="attachments/1668743208/1681391636.png" data-height="433" data-width="1062" data-unresolved-comment-count="0" data-linked-resource-id="1681391636" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="image-20250311-173920.png" data-base-url="https://varlab-dev.atlassian.net/wiki" data-linked-resource-content-type="image/png" data-linked-resource-container-id="1668743208" data-linked-resource-container-version="22" data-media-id="dca1c865-6ec7-4f95-bc9d-d545d5286555" data-media-type="file" /></span><p style="margin-left: 30.0px;"><strong>[Reference]</strong><br />&gt;&gt;<a class="external-link" href="https://www.jenkins.io/doc/book/using/remote-access-api/" rel="nofollow"> <u>What is Jenkins API?</u></a></p><p /><h3 style="margin-left: 30.0px;" id="JenkinsSecurity-4.1.4SonarQube"><strong>4.1.4 SonarQube</strong></h3><p style="margin-left: 30.0px;">: This is the <strong>SonarQube authentication token assigned to the admin user</strong>. Jenkins primarily uses this token for the SonarQube REST API, especially when retrieving static code analysis results from the SonarQube server.</p><p style="margin-left: 30.0px;"><strong>[Reference]</strong><br />&gt;&gt; <a class="external-link" href="https://docs.sonarsource.com/sonarqube-server/10.8/user-guide/managing-tokens/" rel="nofollow"><u>About SonarQube User Token</u></a><br />&gt;&gt; <a href="https://varlab-dev.atlassian.net/wiki/spaces/DPD/pages/1469808648/Static+Code+Analysis+using+SonarQube#2.3-Install-Sonar-Scanner-Plugin-in-Jenkins" rel="nofollow"><u>Setup SonarQube User Token</u></a></p><p /><h2 id="JenkinsSecurity-4.2ProjectLevelCredentials">4.2 Project Level Credentials</h2><p>: These credentials are<strong> assigned to a specific folder (project) </strong>and can be accessed <strong>via:</strong><br />&quot;{Project Folder} &rarr; Credentials &rarr; Stores scoped to {Project Folder} &rarr; {Project Folder} &rarr; Global credentials (unrestricted)&quot;</p><h3 style="margin-left: 30.0px;" id="JenkinsSecurity-4.2.1trigger-token"><strong>4.2.1 trigger-token</strong></h3><p style="margin-left: 30.0px;">: This token serves as the target endpoint for each project. Specifically, <strong>Jenkins distinguishes and routes each build job based on this token</strong>.  So, this trigger-token should be matched with Bitbucket webhook URL of each project. </p><p style="margin-left: 30.0px;"> <strong>For example</strong>, the trigger-token should be &lsquo;<code>devops-pipeline</code>' if we want to trigger the '<code>devops-pipeline</code>&rsquo; project and the webhook URL is &ldquo;<code>https://jenkins.vconestoga.com/generic-webhook-trigger/invoke?token=devops-pipeline</code>&rdquo;</p><div class="confluence-information-macro confluence-information-macro-information"><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon" /><div class="confluence-information-macro-body"><p>Unlike other credentials, <strong>'trigger-token'</strong> <strong>is a user-defined token name</strong>. Therefore, <u>maintaining a consistent naming convention is recommended</u>.</p></div></div><p style="margin-left: 30.0px;"><strong>[Reference]</strong><br />&gt;&gt; <a href="https://varlab-dev.atlassian.net/wiki/spaces/DPD/pages/1508605968/Setting+Up+Jenkins+on+the+Linux+Virtual+Machine#B.-Set-Up-the-Webhook-URL-for-the-Target-Repository" rel="nofollow"><u>How to set webhook on Bitbucket repository?</u></a></p><p /><h3 style="margin-left: 30.0px;" id="JenkinsSecurity-4.2.2bitbucket-access-token"><strong>4.2.2 bitbucket-access-token </strong></h3><p style="margin-left: 30.0px;">: <strong>A</strong> <strong>Bitbucket Access Token</strong> is a repository, project, or workspace-scoped token used for<strong> API authentication</strong> and tool integration, such as CI/CD. </p><p style="margin-left: 30.0px;">In our pipeline, Jenkins uses this token for <strong>API authentication, such as Bitbucket PR reports, annotations, and build status updates</strong>.</p><p style="margin-left: 30.0px;">In other words, this token is required whenever Jenkins interacts with Bitbucket over HTTP.</p><p style="margin-left: 30.0px;"><strong>[Reference]</strong><br />&gt;&gt; <a href="https://varlab-dev.atlassian.net/wiki/spaces/DPD/pages/1508605968/Setting+Up+Jenkins+on+the+Linux+Virtual+Machine#2.4-Set-Up-Bitbucket-Repository-Access-Token" rel="nofollow"><u>How to set bitbucket-access-token on Bitbucket and Jenkins?</u></a></p><p /><hr /><h1 id="JenkinsSecurity-5.SSHConnectionstoaWebHostServer"><strong>5. SSH Connections to a Web Host Server</strong></h1><p>: Jenkins uses an RSA public key to connect to the <code>dlx-webhost</code> and <code>dlx-econestoga</code> servers with <code>vconadmin</code> user permission.</p><div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon" /><div class="confluence-information-macro-body"><p>The <code>vconadmin</code> user, authenticated via an RSA public key, generally <u>has sufficient permissions</u>, so using <code>sudo</code><strong> is not recommended</strong></p></div></div><p><br />Jenkins is using this SSH connections in following situations:</p><p style="margin-left: 30.0px;"><strong>[DLX Pipeline]</strong></p><p style="margin-left: 30.0px;">- Copy <u>Unity code coverage report</u> to web hosting directory in dlx-webhost server</p><p style="margin-left: 30.0px;">- Copy <u>Unity WebGL build</u> to web hosting directory in dlx-webhost server</p><p style="margin-left: 30.0px;">- Copy <u>Unity WebGL build</u> to web hosting directory in dlx-econestoga server</p><p /><p style="margin-left: 30.0px;"><strong>[JS Pipeline]</strong></p><p style="margin-left: 30.0px;">- Copy <u>Jest and Vitest code coverage reports</u> to web hosting directory in dlx-webhost server</p><p /><hr /><h1 id="JenkinsSecurity-6.ScriptApprovals"><strong>6. Script Approvals</strong></h1><p>: <strong>Jenkins Script Approval</strong> is a feature that allows Groovy scripts to be subject to security review when running in Jenkins. If a specific API or method call is not allowed,<strong> the script must be reviewed and approved by an administrator before it can be run</strong>. </p><p>This setting can be found &ldquo;Manage Jenkins &gt;&gt; Script Approvals&ldquo;</p><p /><p>Here is the list of script approvals that have potential security danger:</p><div class="table-wrap"><table data-table-width="760" data-layout="default" data-local-id="fdc82f37-5831-4ceb-86f9-a9bc30fcc698" class="confluenceTable"><tbody><tr><th data-highlight-colour="#ffffff" class="confluenceTh"><p><code>new java.io.File()</code></p><ul><li><p><strong>Usage</strong><br />: Allows <u>directly access the file system</u> in the form <code>new File(&quot;/path/to/file&quot;)</code></p></li><li><p><strong>Vulnerability</strong><br />: <strong>Enables manipulation of the server's file system</strong>, potentially leading to sensitive information leaks and unauthorized data modifications.</p></li><li><p><strong>Potential Solution</strong><br />: Use <code>hudson.FilePath()</code>, a Jenkins API that <strong><span style="background-color: rgb(254,222,200);">restricts file access to the Jenkins workspace</span></strong>, reducing security risks.</p></li></ul></th></tr></tbody></table></div><div class="table-wrap"><table data-table-width="760" data-layout="default" data-local-id="d62c2c1b-8838-4700-b5ff-5d43fa9ba6e6" class="confluenceTable"><tbody><tr><th data-highlight-colour="#ffffff" class="confluenceTh"><p><code>JsonOutput.toJson()</code></p><ul><li><p><strong>Usage</strong><br />: <u>Converts a Groovy object into a JSON string</u>, commonly used for serializing data in API responses, logging, or storing structured data.</p></li><li><p><strong>Vulnerability</strong><br />: May <u>expose sensitive data</u> (e.g., passwords, API keys, authentication tokens) in logging or API response if objects contain confidential information.</p></li><li><p><strong>Potential Solution</strong><br /> <u>Filter the JSON result</u> before log or print</p></li></ul><div id="expander-1685523539" class="expand-container"><div id="expander-control-1685523539" class="expand-control"><span class="expand-control-icon"><img style="vertical-align:middle;" class="expand-control-image" src="images/icons/grey_arrow_down.png"/></span><span class="expand-control-text">Example Codes</span></div><div id="expander-content-1685523539" class="expand-content"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">def safeData = userData.findAll { it.key != 'password' &amp;&amp; it.key != 'apiKey' }
println JsonOutput.toJson(safeData)</pre>
</div></div></div></div></th></tr></tbody></table></div><div class="table-wrap"><table data-table-width="760" data-layout="default" data-local-id="11019b12-d00c-4640-81bd-d64c7c9308ed" class="confluenceTable"><tbody><tr><th data-highlight-colour="#ffffff" class="confluenceTh"><p><code>execute()</code></p><ul><li><p><strong>Usage</strong><br />: <u>Executes a system command</u> as a child process using Groovy&rsquo;s <code>execute()</code> method.</p></li><li><p><strong>Vulnerability - Remote Code Execution (RCE)</strong><br />: If unvalidated user input is passed to <code>execute()</code>, attackers can inject malicious commands. </p></li><li><p><strong>Potential Solution</strong><br />: Use <code>hudson.util.ArgumentListBuilder()</code> which is <u>buit-in Jenkins API</u>. This library securely constructs command-line arguments by <u>treating each parameter separately, preventing command injection attacks</u>.<br /> Unlike raw string concatenation in <code>execute()</code>, it ensures that arguments are safely escaped and executed <u>within Jenkins' controlled environment</u>.</p></li></ul><div id="expander-744420813" class="expand-container"><div id="expander-control-744420813" class="expand-control"><span class="expand-control-icon"><img style="vertical-align:middle;" class="expand-control-image" src="images/icons/grey_arrow_down.png"/></span><span class="expand-control-text">Example Codes</span></div><div id="expander-content-744420813" class="expand-content"><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<pre class="syntaxhighlighter-pre" data-syntaxhighlighter-params="brush: java; gutter: false; theme: Confluence" data-theme="Confluence">import hudson.util.ArgumentListBuilder
import jenkins.model.Jenkins

def args = new ArgumentListBuilder()
args.add(&quot;echo&quot;, &quot;Safe Execution&quot;)  // Adds command arguments safely

// Get the Jenkins Launcher to Run Commands
// TaskListener.NULL == no output logging
def launcher = Jenkins.instance.createLauncher(TaskListener.NULL)

// Run the command 
def proc = launcher.launch().cmds(args).start()

// wait for the command to finish
proc.join() </pre>
</div></div></div></div></th></tr></tbody></table></div><div class="table-wrap"><table data-table-width="760" data-layout="default" data-local-id="78253306-e505-4e20-90f2-0cb1348ff60c" class="confluenceTable"><tbody><tr><th data-highlight-colour="#ffffff" class="confluenceTh"><p><code>getProperties()</code> <br /><span style="background-color: rgb(254,222,200);">&gt;&gt; We are not using this method, but Jenkins reports a warning about it. More investigation is required&hellip;</span></p><ul><li><p><strong>Usage</strong><br />: </p></li><li><p><strong>Vulnerability </strong><br />: </p></li><li><p><strong>Potential Solution</strong><br />: </p></li></ul><div id="expander-1748490368" class="expand-container"><div id="expander-control-1748490368" class="expand-control"><span class="expand-control-icon"><img style="vertical-align:middle;" class="expand-control-image" src="images/icons/grey_arrow_down.png"/></span><span class="expand-control-text">Example Codes</span></div><div id="expander-content-1748490368" class="expand-content"><p /></div></div></th></tr></tbody></table></div><p>	</p>
                    </div>

                                        <div class="pageSection group">
                        <div class="pageSectionHeader">
                            <h2 id="attachments" class="pageSectionTitle">Attachments:</h2>
                        </div>

                        <div class="greybox" align="left">
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/1668743208/1678278741.png">image-20250310-202939.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/1668743208/1678540869.png">화면 캡처 2025-03-10 162758-20250310-202924.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/1668743208/1681391617.png">image-20250311-140341.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/1668743208/1681096717.png">image-20250311-140346.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/1668743208/1681358862.png">image-20250311-152728.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/1668743208/1681621011.png">image-20250311-153037.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/1668743208/1681358876.png">image-20250311-173917.png</a> (image/png)
                                <br/>
                                                            <img src="images/icons/bullet_blue.gif" height="8" width="8" alt=""/>
                                <a href="attachments/1668743208/1681391636.png">image-20250311-173920.png</a> (image/png)
                                <br/>
                                                    </div>
                    </div>
                    
                                                      
                </div>             </div> 
            <div id="footer" role="contentinfo">
                <section class="footer-body">
                    <p>Document generated by Confluence on May 27, 2025 13:33</p>
                    <div id="footer-logo"><a href="http://www.atlassian.com/">Atlassian</a></div>
                </section>
            </div>
        </div>     </body>
</html>
